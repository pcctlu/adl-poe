<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
</head>
<body>
	<pre>



import tensorflow as tf
from tensorflow import keras
import matplotlib.pyplot as plt


data= keras.datasets.fashion_mnist
(train_images, train_labels),(test_images, test_labels)=data.load_data()


def build_conv_autoencoder():
    #Encoder
    encoder = keras.Sequential([
        keras.layers.Input(shape=(28, 28, 1)),
        keras.layers.Conv2D(32, (3, 3), activation='relu', padding='same'),
        keras.layers.Conv2D(64, (3, 3), activation='relu', padding='same'),
        keras.layers.MaxPooling2D((2, 2))
    ], name='encoder')

    #Decoder
    decoder = keras.Sequential([
        keras.layers.UpSampling2D((2, 2)),
        keras.layers.Conv2D(64, (3, 3), activation='relu', padding='same'),
        keras.layers.Conv2D(32, (3, 3), activation='relu', padding='same'),
        keras.layers.Conv2D(1, (3, 3), activation='sigmoid', padding='same')
    ], name='decoder')

    #Autoencoder
    autoencoder_input = keras.layers.Input(shape=(28, 28, 1))
    encoded = encoder(autoencoder_input)
    decoded = decoder(encoded)
    autoencoder = keras.Model(autoencoder_input, decoded, name='autoencoder')

    autoencoder.compile(optimizer='adam', loss='binary_crossentropy')
    return autoencoder


autoencoder = build_conv_autoencoder()
autoencoder.summary()


#Preprocess the images: reshape and normalize
train_images_reshaped = train_images.reshape((train_images.shape[0], 28, 28, 1)).astype('float32') / 255.

#Train the autoencoder
history = autoencoder.fit(
    train_images_reshaped,
    train_images_reshaped,
    epochs=10,
    batch_size=128,
    shuffle=True,
    validation_data=(test_images.reshape((test_images.shape[0], 28, 28, 1)).astype('float32') / 255.,
                     test_images.reshape((test_images.shape[0], 28, 28, 1)).astype('float32') / 255.))



import numpy as np

#Preprocess test images for prediction
test_images_reshaped = test_images.reshape((test_images.shape[0], 28, 28, 1)).astype('float32') / 255.

#Predict reconstructions for a subset of test images
#Let's pick the first 10 test images
num_images_to_show = 5
original_images = test_images_reshaped[:num_images_to_show]
reconstructed_images = autoencoder.predict(original_images)

plt.figure(figsize=(20, 4))
for i in range(num_images_to_show):
    #Original Image
    ax = plt.subplot(2, num_images_to_show, i + 1)
    plt.imshow(original_images[i].reshape(28, 28), cmap='gray')
    plt.title("Original")
    plt.axis("off")

    #Reconstructed Image
    ax = plt.subplot(2, num_images_to_show, i + 1 + num_images_to_show)
    plt.imshow(reconstructed_images[i].reshape(28, 28), cmap='gray')
    plt.title("Reconstructed")
    plt.axis("off")
plt.show()







	</pre>

</body>
</html>